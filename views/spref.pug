extends layout

block content
  .page-header

    h3 All Books
    head
      script(type='text/javascript').
        function change_table() {
          console.log('mimsey!')
          //gettting json values
          var spref_json = document.getElementById("spref_json").value;
          var spref_json_value = JSON.parse( spref_json );

          //clearing table
          var table = document.getElementById("myTableData");
          table.getElementsByTagName("tbody")[0].innerHTML = table.rows[0].innerHTML;



          };





    #mydata
      b Current data in the system ...
      br
      br

      input(type='hidden', id="spref_json", value= JSON.stringify(spref))

      select#ddl(onchange="change_table()")
        option(value='')
        script.
         var spref_json = document.getElementById("spref_json").value;
         var spref_json_value = JSON.parse( spref_json );
         var listItems = [];

         //putting items into initial ist
         for (var i = 0; i < spref_json_value.length; i++){
           itemTest= spref_json_value[i].date_range_start + " to " + spref_json_value[i].date_range_end ;
           listItems[i]=itemTest
          }

          //removing duplicates
          var seen = {};
          var out = [];
          var j = 0;
          for(var i = 0; i < listItems.length; i++) {
              var item = listItems[i];
              if(seen[item] !== 1) {
                    seen[item] = 1;
                    out[j++] = item;
              }
         }

         //putting values form de-deuped list into dropdown
         var dropdown = document.getElementById("ddl");
         for (var i = 0; i<out.length; i++){
           var itemTest= out[i]
           dropdown[dropdown.length] = new Option(itemTest, itemTest);
         }

         console.log(out)




      .form-group
        .col-sm-offset-3.col-sm-7
          button.col-sm-3.btn.btn-primary(type='submit', value='Add') Save shifts
      br
      br

      table#myTableData(border='1', cellpadding='2')
        tr
          th
            b Employee type
          th
            b Days worked
          th
            b Number of employees
          th
            b Shift start
          th
            b Shift end
          th
            b Available


        each shf in spref

          // build a new table row
          tr

            // insert table data
            td #{shf.employee_type}
            td #{shf.days_worked}
            td #{shf.num_employees}
            td #{shf.shift_start_time}
            td #{shf.shift_end_time}



            // add the update and delete buttons
            td
              input#type(type='checkbox', name='Available', value = 'yes', autofocus='autofocus')



            // move to next person in the people array ...
